<!DOCTYPE html>
<html>
<head>
    <title>My Cares</title>
</head>
<body>
    <h1>My Cares</h1>
    <div>
        <form method="get">
            <label for="care_state">Care State:</label>
            <select name="care_state" id="care_state">
                <option value="">All</option>
                {% for state in care_states %}
                    <option value="{{ state }}" {% if selected_care_state == state %}selected{% endif %}>{{ state }}</option>
                {% endfor %}
            </select>

            <label for="senior_id">Senior:</label>
            <select name="senior_id" id="senior_id">
                <option value="">All</option>
                {% for senior in seniors %}
                    <option value="{{ senior.id }}" {% if selected_senior_id == senior.id|stringformat:"s" %}selected{% endif %}>{{ senior.name }}</option>
                {% endfor %}
            </select>

            <label for="order">Order:</label>
            <select name="order" id="order">
                <option value="desc" {% if selected_order == "desc" %}selected{% endif %}>Newest First</option>
                <option value="asc" {% if selected_order == "asc" %}selected{% endif %}>Oldest First</option>
            </select>

            <button type="submit">Filter</button>
        </form>
    </div>
    <ul>
        {% for care in cares %}
            <li>
                <h2>{{ care.title }}</h2>
                <p>Type: {{ care.care_type }}</p>
                <p>Date: {{ care.datetime }}</p>
                <p>State: {{ care.care_state }}</p>
                <p>Content: {{ care.content }}</p>
                <p>Seniors: 
                    {% for senior in care.seniors.all %}
                        {{ senior.name }}{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </p>
            </li>
        {% endfor %}
    </ul>

    <div class="pagination">
        <span class="step-links">
            {% if page_obj.has_previous %}
                <a href="?{% if request.GET.care_state %}care_state={{ request.GET.care_state }}&{% endif %}
                          {% if request.GET.senior_id %}senior_id={{ request.GET.senior_id }}&{% endif %}
                          {% if request.GET.order %}order={{ request.GET.order }}&{% endif %}
                          page=1">&laquo; first</a>
                <a href="?{% if request.GET.care_state %}care_state={{ request.GET.care_state }}&{% endif %}
                          {% if request.GET.senior_id %}senior_id={{ request.GET.senior_id }}&{% endif %}
                          {% if request.GET.order %}order={{ request.GET.order }}&{% endif %}
                          page={{ page_obj.previous_page_number }}">previous</a>
            {% endif %}

            <span class="current">
                Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
            </span>

            {% if page_obj.has_next %}
                <a href="?{% if request.GET.care_state %}care_state={{ request.GET.care_state }}&{% endif %}
                          {% if request.GET.senior_id %}senior_id={{ request.GET.senior_id }}&{% endif %}
                          {% if request.GET.order %}order={{ request.GET.order }}&{% endif %}
                          page={{ page_obj.next_page_number }}">next</a>
                <a href="?{% if request.GET.care_state %}care_state={{ request.GET.care_state }}&{% endif %}
                          {% if request.GET.senior_id %}senior_id={{ request.GET.senior_id }}&{% endif %}
                          {% if request.GET.order %}order={{ request.GET.order }}&{% endif %}
                          page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
            {% endif %}
        </span>
    </div>
</body>
</html>
